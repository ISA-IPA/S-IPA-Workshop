Mining, analysing and querying data from internal and external databases